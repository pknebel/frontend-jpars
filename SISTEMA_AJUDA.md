# Sistema de Ajuda Inteligente - Documenta√ß√£o

## üìã Vis√£o Geral

Foi implementado um sistema de ajuda inteligente que auxilia o usu√°rio ap√≥s m√∫ltiplas tentativas incorretas nas telas de **Remo√ß√£o de Recurs√£o** e **Fatora√ß√£o**.

## üéØ Objetivo

Oferecer uma experi√™ncia de aprendizado progressiva onde:
- O usu√°rio tem liberdade de tentar resolver o problema
- Ap√≥s 3 tentativas incorretas, o sistema oferece ajuda
- O usu√°rio pode aceitar ou rejeitar a ajuda
- Se rejeitar, ganha mais 3 tentativas
- O processo se repete at√© que o usu√°rio acerte ou aceite a ajuda

## üöÄ Funcionalidades Implementadas

### 1. Contador de Tentativas
- Conta automaticamente tentativas incorretas de valida√ß√£o
- Reinicia quando o usu√°rio acerta ou aceita ajuda
- Exibe logs no console para debug

### 2. Modal de Ajuda
- Aparece ap√≥s 3 tentativas incorretas
- Design moderno e responsivo
- Bloqueia intera√ß√µes at√© que o usu√°rio escolha uma op√ß√£o

### 3. Busca de Resposta Correta
- Busca automaticamente a resposta do backend
- Endpoints espec√≠ficos para cada tela
- Loading overlay durante o carregamento

### 4. Preenchimento Autom√°tico
- Preenche o campo de texto com a resposta correta
- Permite que o usu√°rio valide e continue o fluxo

## üìÅ Arquivos Criados/Modificados

### Novos Arquivos:

#### 1. `/src/components/HelpModal.jsx`
Componente modal reutiliz√°vel para oferecer ajuda.

**Propriedades:**
```javascript
{
  isOpen: boolean,          // Controla visibilidade
  onAccept: () => void,     // Callback quando usu√°rio aceita
  onReject: () => void,     // Callback quando usu√°rio rejeita
  tentativas: number        // N√∫mero de tentativas (sempre 3)
}
```

#### 2. `/src/components/HelpModal.css`
Estilos do modal com anima√ß√µes e responsividade.

**Caracter√≠sticas:**
- Anima√ß√£o de fade-in para overlay
- Anima√ß√£o de slide-up para conte√∫do
- Totalmente responsivo
- Z-index alto (10000) para garantir visibilidade
- Design moderno com gradiente roxo

### Arquivos Modificados:

#### 1. `/src/pages/RemocaoRecursao/index.jsx`
**Adicionado:**
- Estado `tentativasIncorretas` - contador de erros
- Estado `showHelpModal` - controle do modal
- Estado `isLoadingAnswer` - loading ao buscar resposta
- Fun√ß√£o `buscarRespostaCorreta()` - busca do backend
- Fun√ß√£o `handleAcceptHelp()` - quando usu√°rio aceita ajuda
- Fun√ß√£o `handleRejectHelp()` - quando usu√°rio rejeita ajuda
- L√≥gica no `handleValidate()` para incrementar contador
- Modal no JSX
- Loading overlay no JSX

**Endpoint usado:**
```
GET http://localhost:8080/jpars/gramatica/sem-recursao/{idWorkflow}
```

#### 2. `/src/pages/Fatoracao/index.jsx`
**Adicionado:**
- Mesma estrutura da p√°gina de Remo√ß√£o de Recurs√£o
- Estado `tentativasIncorretas`
- Estado `showHelpModal`
- Estado `isLoadingAnswer`
- Fun√ß√£o `buscarRespostaCorreta()`
- Fun√ß√£o `handleAcceptHelp()`
- Fun√ß√£o `handleRejectHelp()`
- L√≥gica no `handleValidate()`
- Modal no JSX
- Loading overlay no JSX

**Endpoint usado:**
```
GET http://localhost:8080/jpars/gramatica/ll1/{idWorkflow}
```

#### 3. `/src/pages/RemocaoRecursao/styles.css`
**Adicionado:**
- Classe `.loading-overlay` - overlay de carregamento
- Estilos para spinner e texto de loading

#### 4. `/src/pages/Fatoracao/styles.css`
**Adicionado:**
- Classe `.loading-overlay` - overlay de carregamento
- Estilos para spinner e texto de loading

## üîÑ Fluxo de Funcionamento

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. Usu√°rio digita gram√°tica            ‚îÇ
‚îÇ     e clica em "Validar"                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2. Sistema valida no backend           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ                ‚îÇ
    ‚úÖ Correto      ‚ùå Incorreto
         ‚îÇ                ‚îÇ
         ‚ñº                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Sucesso!     ‚îÇ  ‚îÇ Incrementa contador  ‚îÇ
‚îÇ Pode avan√ßar ‚îÇ  ‚îÇ tentativasIncorretas ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ tentativas >= 3?    ‚îÇ
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ       ‚îÇ
                   N√£o ‚îÇ       ‚îÇ Sim
                       ‚îÇ       ‚îÇ
                       ‚ñº       ‚ñº
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ Tente      ‚îÇ  ‚îÇ Mostra modal ‚îÇ
              ‚îÇ novamente  ‚îÇ  ‚îÇ de ajuda     ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                     ‚îÇ
                            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                            ‚îÇ                 ‚îÇ
                       Usu√°rio        Usu√°rio
                       aceita         rejeita
                            ‚îÇ                 ‚îÇ
                            ‚ñº                 ‚ñº
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ Busca resposta do    ‚îÇ  ‚îÇ Reseta      ‚îÇ
              ‚îÇ backend e preenche   ‚îÇ  ‚îÇ contador    ‚îÇ
              ‚îÇ automaticamente      ‚îÇ  ‚îÇ para 0      ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üíª Exemplos de Uso

### Como o Sistema Detecta Erro

```javascript
// Em handleValidate()
if (response.ok) {
  // Sucesso - resetar contador
  setTentativasIncorretas(0);
  setIsValidated(true);
} else {
  // Erro - incrementar contador
  const novasTentativas = tentativasIncorretas + 1;
  setTentativasIncorretas(novasTentativas);
  
  // Verificar se atingiu 3 tentativas
  if (novasTentativas >= 3) {
    setShowHelpModal(true);
  }
}
```

### Como Buscar a Resposta Correta

```javascript
// Remo√ß√£o de Recurs√£o
const response = await fetch(
  `http://localhost:8080/jpars/gramatica/sem-recursao/${idWorkflow}`
);

// Fatora√ß√£o
const response = await fetch(
  `http://localhost:8080/jpars/gramatica/ll1/${idWorkflow}`
);
```

### Como o Modal √© Exibido

```jsx
<HelpModal
  isOpen={showHelpModal}
  onAccept={handleAcceptHelp}
  onReject={handleRejectHelp}
  tentativas={3}
/>
```

## üé® Interface do Usu√°rio

### Modal de Ajuda

**Apar√™ncia:**
- Overlay escuro semi-transparente
- Card branco centralizado
- Header com gradiente roxo
- Texto explicativo claro
- Dois bot√µes: "N√£o, quero tentar mais" e "Sim, mostrar resposta"

**Anima√ß√µes:**
- Fade-in do overlay (0.3s)
- Slide-up do conte√∫do (0.3s)
- Hover nos bot√µes com eleva√ß√£o

### Loading Overlay

**Apar√™ncia:**
- Tela cheia com fundo escuro
- Spinner centralizado
- Texto "Buscando resposta correta..."

## üìä Estat√≠sticas da Implementa√ß√£o

- **Arquivos Criados**: 2 (HelpModal.jsx + HelpModal.css)
- **Arquivos Modificados**: 4 (2 p√°ginas + 2 arquivos CSS)
- **Linhas de C√≥digo**: ~300 linhas
- **Componentes Reutiliz√°veis**: 1 (HelpModal)
- **Build Status**: ‚úÖ Compilado com sucesso

## üß™ Como Testar

### Teste 1: Fluxo Completo com Rejei√ß√£o
1. Abra a tela de Remo√ß√£o de Recurs√£o ou Fatora√ß√£o
2. Digite uma gram√°tica incorreta
3. Clique em "Validar" (1¬™ tentativa)
4. Digite outra gram√°tica incorreta
5. Clique em "Validar" (2¬™ tentativa)
6. Digite outra gram√°tica incorreta
7. Clique em "Validar" (3¬™ tentativa)
8. **Modal deve aparecer!**
9. Clique em "N√£o, quero tentar mais"
10. Voc√™ ter√° mais 3 tentativas

### Teste 2: Fluxo com Aceita√ß√£o
1. Siga os passos 1-8 do Teste 1
2. Clique em "Sim, mostrar resposta"
3. **Loading deve aparecer**
4. **Campo deve ser preenchido automaticamente**
5. Mensagem de sucesso deve aparecer
6. Clique em "Validar" para confirmar

### Teste 3: Sucesso na 2¬™ Tentativa
1. Digite uma gram√°tica incorreta (1¬™ tentativa)
2. Digite a gram√°tica correta (2¬™ tentativa)
3. **Modal N√ÉO deve aparecer**
4. Contador deve ser resetado

## üîç Logs no Console

O sistema gera logs detalhados:

```javascript
// Quando erro √© detectado
"Tentativa incorreta 1/3"
"Tentativa incorreta 2/3"
"Tentativa incorreta 3/3"

// Quando busca resposta
"Buscando resposta correta para gram√°tica ID: 1"
"Resposta correta recebida: [conte√∫do]"

// Quando usu√°rio aceita
"Usando gram√°tica do contexto: {...}"
```

## ‚öôÔ∏è Configura√ß√£o

### Alterar N√∫mero de Tentativas

Para mudar de 3 para outro n√∫mero:

1. **No c√≥digo (handleValidate):**
```javascript
// Trocar >= 3 por >= N
if (novasTentativas >= 3) {
  setShowHelpModal(true);
}
```

2. **No modal:**
```jsx
<HelpModal
  tentativas={3}  // Mudar para N
/>
```

### Customizar Mensagens

**Em handleRejectHelp():**
```javascript
setMessage('Voc√™ tem mais 3 tentativas. Boa sorte!');
// Pode ser alterado para qualquer mensagem
```

**Em handleAcceptHelp():**
```javascript
setMessage('Resposta correta preenchida! Clique em "Validar" para continuar.');
// Pode ser alterado para qualquer mensagem
```

## üéì Boas Pr√°ticas Aplicadas

1. **Componentes Reutiliz√°veis**: HelpModal pode ser usado em outras p√°ginas
2. **Separa√ß√£o de Responsabilidades**: L√≥gica separada da apresenta√ß√£o
3. **Estados Independentes**: Cada p√°gina gerencia seus pr√≥prios contadores
4. **Feedback Visual**: Loading, mensagens e anima√ß√µes claras
5. **Acessibilidade**: Modal bloqueia intera√ß√µes at√© decis√£o
6. **Error Handling**: Try-catch em todas as chamadas ao backend
7. **Console Logs**: Facilitam debug e desenvolvimento

## üöÄ Extens√µes Futuras

### Sugest√µes de Melhorias:

1. **Sistema de Dicas Progressivas**
   - 1¬™ tentativa errada: dica b√°sica
   - 2¬™ tentativa errada: dica intermedi√°ria
   - 3¬™ tentativa errada: op√ß√£o de ver resposta

2. **Hist√≥rico de Tentativas**
   - Mostrar tentativas anteriores do usu√°rio
   - Destacar diferen√ßas entre tentativas

3. **Sistema de Pontua√ß√£o**
   - Pontos por acertar de primeira
   - Menos pontos se precisar de ajuda

4. **Analytics**
   - Rastrear quantos usu√°rios precisam de ajuda
   - Identificar gram√°ticas mais dif√≠ceis

5. **Tutorial Interativo**
   - Passo a passo para iniciantes
   - Skip para usu√°rios experientes

## üîí Seguran√ßa

- ‚úÖ Valida√ß√£o sempre no backend
- ‚úÖ Resposta correta s√≥ vem do backend (n√£o hardcoded)
- ‚úÖ IDs v√™m do contexto seguro
- ‚úÖ Sem exposi√ß√£o de l√≥gica de valida√ß√£o no frontend

## üìû Suporte

Para d√∫vidas sobre o sistema de ajuda:
1. Consulte este documento
2. Verifique os logs no console
3. Examine o c√≥digo de HelpModal.jsx
4. Teste o fluxo completo

---

**Status**: ‚úÖ Implementado e Testado  
**√öltima atualiza√ß√£o**: 2025-10-08  
**Build**: ‚úÖ Compilado com sucesso

